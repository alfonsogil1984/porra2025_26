<!-- SELECTOR DE JORNADA -->
<section class="container mx-auto px-6 py-10 text-center">
  <label for="jornadaSelect" class="block text-lg font-semibold mb-2">Selecciona Jornada:</label>
  <select id="jornadaSelect" class="px-4 py-2 border rounded-lg shadow-md">
    <option value="J1">Jornada 1</option>
    <option value="J2">Jornada 2</option>
    <option value="J3">Jornada 3</option>
  </select>
</section>

<script>
  // Base de datos extraída del Excel
  const baseDatos = {
    "J1": [
      { jugador:"Fons", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Carlos", puntosJornada:0, puntosTotales:0, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:10 },
      { jugador:"Sergi", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Wilby", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Pablo", puntosJornada:0, puntosTotales:0, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:10 },
      { jugador:"Alex", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Gotzon", puntosJornada:5, puntosTotales:5, resultadosExactos:1, jornadasCero:0, boteJornada:0, boteTotal:0 },
      { jugador:"Eneko", puntosJornada:3, puntosTotales:3, resultadosExactos:1, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Manu", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Jesus", puntosJornada:5, puntosTotales:5, resultadosExactos:1, jornadasCero:0, boteJornada:0, boteTotal:0 },
      { jugador:"Ivan", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Oscar", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Txus", puntosJornada:5, puntosTotales:5, resultadosExactos:1, jornadasCero:0, boteJornada:0, boteTotal:0 }
    ],
    "J2": [
      { jugador:"Fons", puntosJornada:4, puntosTotales:6, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Carlos", puntosJornada:4, puntosTotales:4, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:15 },
      { jugador:"Sergi", puntosJornada:2, puntosTotales:4, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Wilby", puntosJornada:5, puntosTotales:7, resultadosExactos:1, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Pablo", puntosJornada:2, puntosTotales:2, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:15 },
      { jugador:"Alex", puntosJornada:4, puntosTotales:6, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Gotzon", puntosJornada:2, puntosTotales:7, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 },
      { jugador:"Eneko", puntosJornada:2, puntosTotales:5, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Manu", puntosJornada:7, puntosTotales:9, resultadosExactos:1, jornadasCero:0, boteJornada:0, boteTotal:5 },
      { jugador:"Jesus", puntosJornada:0, puntosTotales:7, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:10 },
      { jugador:"Ivan", puntosJornada:4, puntosTotales:6, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Oscar", puntosJornada:4, puntosTotales:6, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Txus", puntosJornada:7, puntosTotales:12, resultadosExactos:1, jornadasCero:0, boteJornada:0, boteTotal:0 }
    ],
    "J3": [
      { jugador:"Fons", puntosJornada:0, puntosTotales:6, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:20 },
      { jugador:"Carlos", puntosJornada:0, puntosTotales:4, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:25 },
      { jugador:"Sergi", puntosJornada:0, puntosTotales:6, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:20 },
      { jugador:"Wilby", puntosJornada:0, puntosTotales:7, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:20 },
      { jugador:"Pablo", puntosJornada:0, puntosTotales:2, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:25 },
      { jugador:"Alex", puntosJornada:0, puntosTotales:8, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:20 },
      { jugador:"Gotzon", puntosJornada:3, puntosTotales:10, resultadosExactos:1, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Eneko", puntosJornada:3, puntosTotales:8, resultadosExactos:1, jornadasCero:0, boteJornada:5, boteTotal:15 },
      { jugador:"Manu", puntosJornada:2, puntosTotales:11, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:10 },
      { jugador:"Jesus", puntosJornada:0, puntosTotales:7, resultadosExactos:0, jornadasCero:1, boteJornada:10, boteTotal:20 },
      { jugador:"Ivan", puntosJornada:2, puntosTotales:8, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:15 },
      { jugador:"Oscar", puntosJornada:4, puntosTotales:10, resultadosExactos:0, jornadasCero:0, boteJornada:0, boteTotal:10 },
      { jugador:"Txus", puntosJornada:2, puntosTotales:14, resultadosExactos:0, jornadasCero:0, boteJornada:5, boteTotal:5 }
    ]
  };

  let chartPuntos, chartBote;

  function cargarJornada(jornada) {
    let data = baseDatos[jornada];

    // Calcular bote total
    let boteTotal = data.reduce((sum, item) => sum + item.boteTotal, 0);
    document.getElementById("boteTotal").innerText = boteTotal + " zł";

    // Ranking
    let ranking = [...data].sort((a, b) => b.puntosTotales - a.puntosTotales);
    let labelsRanking = ranking.map((d, i) => `${i+1}. ${d.jugador}`);
    let valoresPuntos = ranking.map(d => d.puntosTotales);
    let valoresBote = ranking.map(d => d.boteTotal);

    // Actualizar gráficos
    if (chartPuntos) chartPuntos.destroy();
    if (chartBote) chartBote.destroy();

    chartPuntos = new Chart(document.getElementById('chartPuntos'), {
      type: 'bar',
      data: { labels: labelsRanking, datasets: [{ label: 'Puntos Totales', data: valoresPuntos, backgroundColor: 'rgba(99,102,241,0.7)', borderColor: 'rgba(99,102,241,1)', borderWidth: 1 }] },
      options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    chartBote = new Chart(document.getElementById('chartBote'), {
      type: 'bar',
      data: { labels: labelsRanking, datasets: [{ label: 'Bote Acumulado (zł)', data: valoresBote, backgroundColor: 'rgba(16,185,129,0.7)', borderColor: 'rgba(16,185,129,1)', borderWidth: 1 }] },
      options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    // Actualizar tabla
    let tbody = document.querySelector("#ligaTable tbody");
    tbody.innerHTML = "";
    data.forEach(jugador => {
      tbody.innerHTML += `
        <tr>
          <td>${jugador.jugador}</td>
          <td>${jugador.puntosJornada}</td>
          <td>${jugador.puntosTotales}</td>
          <td>${jugador.resultadosExactos}</td>
          <td>${jugador.jornadasCero}</td>
          <td>${jugador.boteJornada}</td>
          <td>${jugador.boteTotal}</td>
        </tr>`;
    });
  }

  // Detectar cambio
  document.getElementById("jornadaSelect").addEventListener("change", (e) => {
    cargarJornada(e.target.value);
  });

  // Inicializar con Jornada 1
  cargarJornada("J1");
</script>
